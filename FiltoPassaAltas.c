#include <stdio.h>

#include <stdlib.h>

#define N 38



// protótipos das sub-rotinas

void ExibirMatriz(int[][N]);

int Filtrar(int[][N], int[3][3], int, int);

void Convoluir(int[][N], int[3][3], int[][N]);



// programa principal

int main()

{

    int M[N][N] = {

    {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5, 15, 15, 15, 15,  5,  5,  5, 15, 15, 15, 15, 15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  5, 15, 15,  5,  5,  5,  5,  5, 15, 15, 15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  5,  5,  5, 15, 15, 15, 15,  5,  5,  5,  5, 15, 15, 15,  5,  5,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  5,  5,  5, 15, 15, 15, 15,  5,  5,  5,  5, 15, 15, 15, 15, 15, 15, 15,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15,  0,  0,  0,  0},

    {  0,  0,  0,  5,  5,  5,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15,  0,  0,  0,  0},

    {  0,  0,  0,  5,  5,  5,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  5,  5,  5,  5,  5,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  5, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0},

    {  0,  0,  0,  5,  5,  5,  5,  5,  5,  5, 10,  5, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10,  5, 10,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0},

    {  0,  0,  0,  5,  5,  5,  5,  5,  5,  5, 10, 10, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10, 10, 10,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0},

    {  0,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0},

    {  0,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0},

    {  0,  5,  5,  5,  5,  5,  5,  5,  5,  5, 10, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 10,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0},

    {  0, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15,  0,  0},

    {  0, 15, 15, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15,  0,  0},

    {  0,  0,  0, 15, 15, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15,  0,  0,  0,  0},

    {  0,  0,  0, 15, 15, 15, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0},

    {  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0},

    {  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0},

    {  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0, 10, 10, 10, 10, 10, 10, 10, 10, 10,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0},

    {  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0},

    {  0,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0},

    {  0,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  5,  0,  0},

    {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},

    };



    int F[3][3] = {{-1, -1, -1},

                   {-1,  8, -1},

                   {-1, -1, -1}};

    int R[N][N] = {0};



    // fazer a chamada para a exibição da matriz M, aguardar que alguma tecla seja pressionada e limpar a tela


    ExibirMatriz(M);

    system("Pause");
    system("cls");




    // chamar o procedimento para convolução e exibir a matriz R


    Convoluir(M, F, R);

    ExibirMatriz(R);


    return 0;

}



// as sub-rotinas

void ExibirMatriz(int M[][N]){

    int i, j;

    for (i=0; i<N; i++){

        for (j=0; j<N; j++){

            // estou usando o Code::Blocks

            if (M[i][j] < 3)

                printf("%c", 32);

            else

            if (M[i][j] < 6)

                printf("%c", 176);

            else

            if (M[i][j] < 9)

                printf("%c", 177);

            else

            if (M[i][j] < 12)

                printf("%c", 178);

            else

                printf("%c", 219);


        }

        printf("\n");

    }

}



int Filtrar(int M[][N], int F[3][3], int x, int y){

    int i, j;

    int cor = 0;

    // 2 laços de repetição (obrigatórios) para multiplicar os 9 elementos e fazer a soma da nova cor


    for (i = -1; i < 2; i++)
        for (j = -1; j < 2; j++) {
            cor += M[x + i][y + j] * F[i + 1][j + 1];
        }

    return cor;

}



void Convoluir(int M[][N], int F[3][3], int R[][N]){

    int i, j, cor;

    int maior=-255, menor=+255;



    // 2 laços de repetição para calcular a cor do elemento Rij e determinar o maior e menor valor da cor calculada

    // lembre-se de desconsiderar as bordas da matriz R


    for (i = 1; i < (N - 1); i++)
        for (j = 1; j < (N - 1); j++) {
            R[i][j] = Filtrar(M, F, i, j);
            menor = (R[i][j] < menor) ? R[i][j] : menor;
            maior = (R[i][j] > maior) ? R[i][j] : maior;

        }






    // 2 laços de repetição para normalizar a matriz R


    for (i = 1; i < (N - 1); i++)
        for (j = 1; j < (N - 1); j++)
        {
            R[i][j] += abs(menor);
            R[i][j] = R[i][j] * 15;
            R[i][j] = R[i][j] / (maior - menor);
        }




}
